"0","Prior <- function(vector){"
"0","  alpha=vector[1]"
"0","  beta = vector[2]"
"0","  gamma = vector[3]"
"0","  tau.square = vector[4]"
"0","  alpha.p <- dnorm(alpha,0,1)*(alpha>=1)"
"0","  beta.p <- dnorm(beta,0,1)*(beta>=1)"
"0","  gamma.p <- dunif(gamma,0,1)"
"0","  tau.square.p <- dinvgamma(tau.square,1,1)*(tau.square>=0)"
"0","  join <- log(alpha.p + 1e-10) + log(beta.p + 1e-10) + "
"0","          log(gamma.p + 1e-10) + log(tau.square.p + 1e-10)"
"0","  return(-join)"
"0","}"
"0","Posterior <- function(vector){Prior(vector)+Likelihood_3(vector)}"
"0","MPO <- optim(c(1.5, 1.5, 0.02 , 3),Posterior)"
"0","MPO$par"
"1","[1]"
"1"," 2.6887582"
"1"," 1.0000048"
"1"," 0.8771651"
"1"," 0.0718475"
"1","
"
"0","cat('Maximum a Posterior alpha.hat =',MPO$par[1],'\n',"
"0","    'Maximum a Posterior beta.hat =',MPO$par[2],'\n',"
"0","    'Maximum a Posterior gamma =',MPO$par[3],'\n',"
"0","    'Maximum a Posterior tau.square =',MPO$par[4],'\n',"
"0","    ' -log(Posterior) local optim =',Posterior(MPO$par),'\n',"
"0","    ' -log(Posterior) initial value =',Posterior(c(1.1, 1.1, 0.2, 3)))"
"1","Maximum a Posterior alpha.hat ="
"1"," "
"1","2.688758"
"1"," "
"1","
"
"1"," "
"1","Maximum a Posterior beta.hat ="
"1"," "
"1","1.000005"
"1"," "
"1","
"
"1"," "
"1","Maximum a Posterior gamma ="
"1"," "
"1","0.8771651"
"1"," "
"1","
"
"1"," "
"1","Maximum a Posterior tau.square ="
"1"," "
"1","0.0718475"
"1"," "
"1","
"
"1"," "
"1"," -log(Posterior) local optim ="
"1"," "
"1","-19.63019"
"1"," "
"1","
"
"1"," "
"1"," -log(Posterior) initial value ="
"1"," "
"1","27.74527"
