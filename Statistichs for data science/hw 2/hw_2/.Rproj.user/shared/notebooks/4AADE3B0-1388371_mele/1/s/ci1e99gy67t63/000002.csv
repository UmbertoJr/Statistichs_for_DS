"0","states <- c(1,2,3)"
"0","transition_matrix <- matrix(data= c(0,1/2,1/2,"
"0","                                    5/8,1/8,1/4,"
"0","                                    2/3,1/3,0), byrow = TRUE ,nrow=3)"
"0","t0 <- 1"
"0","nsample<-1000"
"0","chain<-rep(NA,nsample+1) # vector that will hold"
"0","# all the simulated values"
"0","chain[1]<-t0             # starting value x1 assigned to chain[1]"
"0","for(t in 1:nsample){"
"0","  chain[t+1]<-sample(states,size=1,prob=transition_matrix[chain[t],])"
"0","}"
"0","prop.table(table(chain))"
"1","chain
"
"1","        1 "
"1","        2 "
"1","        3 "
"1","
"
"1","0.4005994 "
"1","0.3286713 "
"1","0.2707293 "
"1","
"
