{
    "collab_server" : "",
    "contents" : "##### Let us start with some MCMC algorithm\n##### This is our first Gibbs Sampling algorithm \n\n#### Let us visualize the full conditionals \n#### for simulating X|Y and Y|X\n#### in the case where our target ditribution foy\n#### (X,Y) is a (correlated) bivariate gaussian with\n#### correlation rho=-0.7\n\nrho=-0.7\n\nlibrary(mvtnorm)\n\n# means vector mu  ...\n\nmu=c(0,0)\n\n# ... and variance-covariance matrix Sigma\n\nSigma=matrix(c(1,rho,rho,1),ncol=2)\n\nxx=seq(-4,4,0.1)\nyy=seq(-4,4,0.1)\ntemp=cbind(rep(xx,length(yy)),rep(yy,each=length(xx)))\nzz=matrix(dmvnorm(temp,mean=mu,sigma=Sigma),nrow=length(xx))\n\ncontour(x=xx,y=yy,z=zz) \n\nsample2=rmvnorm(1000,mean=mu,sigma=Sigma)\npoints(sample2)\n\n\nlibrary(rgl)\nopen3d()\npersp3d(x=xx,y=yy,z=zz,xlab=\"X\",ylab=\"Y\",zlab=\"f(x,y)\",main=paste(\"Bivariate Normal - rho =\",rho),col=\"green3\")\ngrid3d(c(\"x\", \"y+\", \"z\"), n =20)\n\n\n\n# but also \npersp(xx,yy,zz,zlim=c(0,0.35))\n# with titles and a better viewpoint \npersp(xx,yy,zz,zlim=c(0,0.35),theta=30,phi=35,col = \"lightblue\",xlim=c(-4,4),ylim=c(-4,4))\n\n# we overlap a RED line/band to highlight the initial full-conditionals\n# provided that the first initial point at t=0 is x=0.5 y=-0.8\n\n# the full-conditional for x|y \nxx=seq(-4,4,0.1)\nyy=c(-0.8,-0.75) \ntemp=cbind(rep(xx,2),rep(yy,each=length(xx)))\nzz=matrix(dmvnorm(temp,mean=mu,sigma=Sigma),nrow=length(xx))\npar(new=T)\npersp(xx,yy,zz,zlim=c(0,0.35),theta=30,phi=35,col = \"red\",xlim=c(-4,4),ylim=c(-4,4))\n\n# the full-conditional for y|x\nxx=c(0.4,0.45)\nyy=seq(-4,4,0.1)\ntemp=cbind(rep(xx,each=length(yy)),rep(yy,2))\nzz=matrix(dmvnorm(temp,mean=mu,sigma=Sigma),nrow=length(xx),byrow=T)\npar(new=T)\npersp(xx,yy,zz,zlim=c(0,0.35),theta=30,phi=35,col = \"green\",xlim=c(-4,4),ylim=c(-4,4))\n\ntitle(main=\"Highlighting full-conditionals in the bivariate normal case\")\n\n\n##########################################\n#   Gibbs sampling - Bivariate Normal\n##########################################\n\n# \n\nnsim=1000\nrho=-0.7\n\n# initialization\ntheta1.0=-30\ntheta2.0=30\n\npresent.theta1=theta1.0\npresent.theta2=theta2.0\n\ntheta1sim=c(present.theta1)\ntheta2sim=c(present.theta2)\n\n\nfor(t in 1:nsim){\n  \n  # generic iteration (updating) at time t \n  \n  updated.theta1=rnorm(1,mean=rho*present.theta2,sd=sqrt(1-rho^2))\n  updated.theta2=rnorm(1,mean=rho*updated.theta1,sd=sqrt(1-rho^2))\n  \n  present.theta1=updated.theta1\n  present.theta2=updated.theta2\n  \n  theta1sim=c(theta1sim,present.theta1)\n  theta2sim=c(theta2sim,present.theta2)\n  \n}\n\nthetasim=cbind(theta1sim,theta2sim)\n\nplot(theta1sim,theta2sim);abline(h=0);abline(v=0)\n\n# plot(theta1sim,theta2sim,xlim=c(-5,5),ylim=c(-5,5));abline(h=0);abline(v=0)\n\n# first 10 \n# plot(theta1sim[1:10],theta2sim[1:10]);abline(h=0);abline(v=0)\n# text(theta1sim[1:10]+1,theta2sim[1:10]+1,label=1:10)\n\ncor(theta1sim,theta2sim)\n\n### now we can write our Gibbs sampling as a function!!\n\ngibbs.biv.norm<-function(iter,theta1,theta2,rho){\n  gibbssample<-c()\n  for(g in 1:iter){\n    theta1<-rnorm(1,mean=rho*theta2,sd=sqrt(1-rho^2))\n    theta2<-rnorm(1,mean=rho*theta1,sd=sqrt(1-rho^2))\n    gibbssample<-c(gibbssample,theta1,theta2)\n  }\n  gibbssample<-matrix(gibbssample,nrow=2)\n  return(gibbssample)\n}\n\n\n\n#### NOTE\n# to simulate a generic \n# multivariate normal starting from i.i.d multivariate normal\n# with mean vector mu ...\n\nmu=c(1,2)\n\n# ...  and variance covariance matrix\n\nSigma=matrix(c(1,-0.8,-0.8,1),ncol=2)\n\n# using singular value decomposition \ndec=svd(Sigma)\n\ndec\ndec$u%*%diag(dec$d)%*%dec$v\n\n# thanks to the matrix A which acts as the \"square root of Sigma\" or \"Sigma^(0.5)\"\nA=dec$u%*%diag(dec$d)^(0.5)\n# so that A%*%t(A) returns Sigma\nx=rnorm(2)\n\nx=matrix(rnorm(2000),nrow=2)\n\ny=(A%*%x+mu)\n\n",
    "created" : 1495638107528.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4160201165",
    "id" : "21D4E721",
    "lastKnownWriteTime" : 1495638154,
    "last_content_update" : 1495638154756,
    "path" : "C:/Users/Umbertojunior/Desktop/data science/Second Semestr/SDS 2/hw 2/hw_2/first_toy_example.R",
    "project_path" : "first_toy_example.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 9,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}