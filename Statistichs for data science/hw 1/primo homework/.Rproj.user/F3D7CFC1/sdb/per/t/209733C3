{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Homework 1\"\nauthor: \"Umberto Junior Mele 1388371\"\ndate: \"13 marzo 2017\"\noutput: pdf_document\n---\n\n\na)\n\n$Y_i$ is a random variable with distribution $Bernoulli$ and $i.i.d.$ so we can write down the joint distribution, like this:\n\n$$Pr(Y_{1}=y_1,......, Y_{100}= y_{100} |\\theta) = \\prod_{i=1}^{100} \\theta^{y_i}(1 -\\theta)^{1-y_i}= L(\\theta)$$\nwhere $L(\\theta)$ is the Likelihood function.\n\nWhile the probability distribution of $Pr(\\sum_{i=1}^{100} Y_i = y |\\theta)$\nis defined by the random variable $Z=Y_1 + .... + Y_{100}$, that is distribuited like a Binomial distribution, so:\n$$Pr(\\sum_{i=1}^{100} Y_i = y |\\theta) = Pr(Z=y) = \\binom{100}{y} \\theta^y (1 - \\theta)^{100-y} $$\n\n\n\n2)\n\n```{r}\ntheta <- seq(0,1,0.1)\nprob_Z.equal.57 <- dbinom(57 ,100, theta)\nplot(theta, prob_Z.equal.57, xlab = 'theta' , ylab = 'prob')\n```\n\n\n\n3)\nRemembering that the posterior distribution is:\n$$\\pi(\\theta | x) = \\frac{L(\\theta) \\cdot \\pi(\\theta)}{m(x)}$$\n\n```{r}\nprior <- function(t)  1/11 *(t < 1 & t >0)\nL <-  function(t) dbinom(57,100,t)\nm <- function(all.theta){\n  su <- 0\n  for(t in all.theta){\n    su <- su + prior(t)*L(t)\n  }\n  return(su)\n}\n\nposterior <- function(t) prior(t)*L(t)/m(theta)\nposterior <- Vectorize(posterior)\n\nplot(theta ,posterior(theta), ylab = 'posterior')\ncurve(posterior(x), add = T, col='blue')\n\n```\n\n```{r}\nprior <- function(t) dunif(t)*(t>0 & t<1 )\nL <-  function(t) dbinom(57,100,t)\njoint <- function(t) L(t)*prior(t)\nm <- integrate(joint,0,1)\n\nposterior <- function(t) prior(t)*L(t)/m$value\nposterior <- Vectorize(posterior)\n\ncurve(posterior, col = 'violet')\n\n\n```\n\n\ne)\nWe know that the posterior distribution is a $Beta(1+57, 1 +43)$ because if we use the Conjugate Analysis for this problem, so we use a $Beta$ distro as Prior:\n\n$$\\pi(\\theta | \\bar{Z}) = \\binom{100}{57} \\theta^{57} (1 - \\theta)^{100-57} \\cdot \\frac{\\theta^{\\alpha - 1}(1 - \\theta)^{\\beta - 1}}{\\beta(\\alpha,\\beta)} \\propto \\theta^{57 + \\alpha-1} (1 - \\theta )^{43 + \\beta -1}$$\n\nso the posterior distribution is a $Beta$ distribution with parameters $\\dot\\alpha = 57 + \\alpha$ and $\\dot\\beta = 43 + \\beta$, so the prior distribution is a $Beta(1,1)$ that is the same distribution of a $Unif(0,1)$.\n\n\n```{r}\ncurve(dbeta(x,1,1))\n```\n```{r}\nprior <- function(t) dbeta(t,1,1)*(t>0 & t<1 )\nL <-  function(t) dbinom(57,100,t)\njoint <- function(t) L(t)*prior(t)\nm <- integrate(joint,0,1)\n\nposterior_3 <- function(t) prior(t)*L(t)/m$value\nposterior_3 <- Vectorize(posterior_3)\n\ncurve(posterior_3, col = 'green')\n\n```\n\n\n\n\n\n2)\na)\n\nThe prior predictive distribution is defined by:\n$$m(\\cdot) = \\int f(\\cdot | \\theta) \\pi(\\theta) d\\theta = \\int \\frac{\\sqrt{\\lambda}}{\\sqrt{2\\pi}}e^{- \\frac{\\lambda(x - \\theta)^2}{2}} \\cdot \\frac{\\sqrt{\\nu}}{\\sqrt{2\\pi}}e^{- \\frac{\\nu(\\theta - \\mu)^2}{2}} d\\theta $$\n$$ \\propto  \\int e^{-\\frac{\\lambda(x^2- 2 \\theta x +\\theta^2)+ \\nu(\\theta^2 - 2\\theta \\mu + \\mu^2)}{2}}d\\theta $$\nbut we can use also a trick ...\n$$X \\sim N(\\theta, \\lambda= \\frac{1}{\\sigma^2}) $$\n$$ \\theta \\sim N(\\mu, \\nu=\\frac{1}{\\sigma_{\\mu}^2})$$\n$$X = (X - \\theta) + \\theta$$\n$$(X-\\theta)\\sim N(0,\\lambda)$$\n\n$$X \\sim N(0,\\lambda) + N(\\mu, \\nu) \\sim N(\\mu, \\frac{\\lambda + \\nu}{\\lambda \\nu})$$\n\nb)\nwe know that:\n$$m(x_{new}|x) = \\int f(x_{new}| \\theta) \\pi(\\theta | x) d\\theta$$\nWhere $\\pi(\\theta | x)$ is the posterior distribution that is a $N(\\mu_{\\theta}^{'} , \\lambda_{\\theta}^{'} )$:\n$$ \\mu_{\\theta}^{'} = w \\cdot \\mu + (1 - w)\\cdot \\bar x_n$$\n$$ \\lambda_{\\theta}^{'} = \\nu + N \\lambda$$\nand:\n\n$$w = \\frac{\\nu}{\\nu + N \\lambda}$$\nusing the same trick we did before:\n\n$$m(x_{new}|x) \\sim N(\\mu_{\\theta}^{'}, \\frac{\\lambda_{\\theta}^{'} + \\lambda}{\\lambda_{\\theta}^{'} \\cdot \\lambda})$$\n",
    "created" : 1489592868774.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2037100885",
    "id" : "209733C3",
    "lastKnownWriteTime" : 1489565543,
    "last_content_update" : 1489565543,
    "path" : "C:/Users/Umbertojunior/Desktop/data science/Second Semestr/SDS 2/hw 1/primo homework/homework_1_copia.Rmd",
    "project_path" : "homework_1_copia.Rmd",
    "properties" : {
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}